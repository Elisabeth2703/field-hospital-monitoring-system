{% extends 'patients/base.html' %} {% block title %}–û—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç - {{
staff.full_name }}{% endblock %} {% block content %}
<div style="margin-bottom: 30px">
  <h2 style="color: #2c3e50; margin-bottom: 10px">üè† –û—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç</h2>
  <p style="color: #7f8c8d">–ö–µ—Ä—É–≤–∞–Ω–Ω—è –≤–∞—à–∏–º –ø—Ä–æ—Ñ—ñ–ª–µ–º —Ç–∞ –ø–µ—Ä–µ–≥–ª—è–¥ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏</p>
</div>

<div
  style="
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 40px;
    border-radius: 16px;
    margin-bottom: 30px;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
  "
>
  <div style="display: flex; align-items: center; gap: 30px">
    <div
      style="
        font-size: 96px;
        background: white;
        border-radius: 50%;
        width: 140px;
        height: 140px;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      "
    >
      {{ staff.avatar }}
    </div>
    <div style="flex: 1">
      <h1 style="font-size: 32px; margin-bottom: 10px">
        {{ staff.full_name }}
      </h1>
      <div style="display: flex; gap: 20px; flex-wrap: wrap; opacity: 0.9">
        <div style="display: flex; align-items: center; gap: 8px">
          <span style="font-size: 20px">üëî</span>
          <span>{{ staff.role }}</span>
        </div>
        {% if staff.specialization %}
        <div style="display: flex; align-items: center; gap: 8px">
          <span style="font-size: 20px">ü©∫</span>
          <span>{{ staff.specialization }}</span>
        </div>
        {% endif %}
        <div style="display: flex; align-items: center; gap: 8px">
          <span style="font-size: 20px">üÜî</span>
          <span>@{{ staff.username }}</span>
        </div>
      </div>
      <div
        style="
          margin-top: 15px;
          padding: 12px 20px;
          background: rgba(255, 255, 255, 0.2);
          border-radius: 8px;
          display: inline-block;
        "
      >
        <span style="opacity: 0.8">–ó–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω–æ:</span>
        <strong>{{ staff.registration_date|date:"d.m.Y" }}</strong>
        {% if staff.last_login %}
        <span style="margin-left: 20px; opacity: 0.8">–û—Å—Ç–∞–Ω–Ω—ñ–π –≤—Ö—ñ–¥:</span>
        <strong>{{ staff.last_login|date:"d.m.Y H:i" }}</strong>
        {% endif %}
      </div>
    </div>
  </div>
</div>

<div
  style="
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  "
>
  <div
    style="
      background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
      padding: 30px;
      border-radius: 12px;
      text-align: center;
    "
  >
    <div style="font-size: 14px; color: #666; margin-bottom: 10px">
      –í—Å—å–æ–≥–æ –ø–∞—Ü—ñ—î–Ω—Ç—ñ–≤
    </div>
    <div style="font-size: 48px; font-weight: bold; color: #2c3e50">
      {{ total_patients }}
    </div>
  </div>

  <div
    style="
      background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
      padding: 30px;
      border-radius: 12px;
      text-align: center;
    "
  >
    <div style="font-size: 14px; color: #666; margin-bottom: 10px">
      –ö—Ä–∏—Ç–∏—á–Ω–∏–π —Å—Ç–∞–Ω
    </div>
    <div style="font-size: 48px; font-weight: bold; color: #c62828">
      {{ critical_patients }}
    </div>
  </div>
</div>

<div
  style="
    background: white;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
    margin-bottom: 30px;
  "
>
  <h3 style="margin-bottom: 20px; color: #2c3e50">
    üë• –û—Å—Ç–∞–Ω–Ω—ñ –∑–∞—Ä–µ—î—Å—Ç—Ä–æ–≤–∞–Ω—ñ –ø–∞—Ü—ñ—î–Ω—Ç–∏
  </h3>
  {% if recent_patients %}
  <div style="display: grid; gap: 15px">
    {% for patient in recent_patients %}
    <div
      style="
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 15px;
        background: #f8f9fa;
        border-radius: 8px;
      "
    >
      <div>
        <div style="font-weight: 600; color: #2c3e50; margin-bottom: 5px">
          {{ patient.full_name }}
        </div>
        <div style="font-size: 12px; color: #7f8c8d">
          <code
            style="
              background: #e3f2fd;
              padding: 2px 8px;
              border-radius: 4px;
              margin-right: 10px;
            "
            >{{ patient.bracelet_id }}</code
          >
          {{ patient.injury_type }}
        </div>
      </div>
      <div>
        <span
          style="padding: 6px 12px; border-radius: 12px; font-size: 12px; font-weight: bold;
                            background: {% if patient.severity == '–ö—Ä–∏—Ç–∏—á–Ω–∏–π' %}#ffebee; color: #c62828
                            {% elif patient.severity == '–í–∞–∂–∫–∏–π' %}#fff3e0; color: #ef6c00
                            {% elif patient.severity == '–°–µ—Ä–µ–¥–Ω—ñ–π' %}#e3f2fd; color: #1565c0
                            {% else %}#e8f5e9; color: #2e7d32{% endif %};"
        >
          {{ patient.severity }}
        </span>
      </div>
    </div>
    {% endfor %}
  </div>
  {% else %}
  <p style="text-align: center; color: #7f8c8d">–ü–∞—Ü—ñ—î–Ω—Ç—ñ–≤ –Ω–µ–º–∞—î</p>
  {% endif %}
</div>

<div
  style="
    background: white;
    padding: 30px;
    border-radius: 12px;
    box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
  "
>
  <h3 style="margin-bottom: 20px; color: #2c3e50">‚öôÔ∏è –†–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é</h3>

  <form method="post">
    {% csrf_token %}

    <div style="display: grid; gap: 20px">
      <div>
        <label
          style="
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
          "
          >–ü–Ü–ë</label
        >
        <input
          type="text"
          name="full_name"
          value="{{ staff.full_name }}"
          style="
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
          "
        />
      </div>

      <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px">
        <div>
          <label
            style="
              display: block;
              font-weight: 600;
              color: #2c3e50;
              margin-bottom: 8px;
            "
            >Email</label
          >
          <input
            type="email"
            name="email"
            value="{{ staff.email }}"
            style="
              width: 100%;
              padding: 12px;
              border: 2px solid #e0e0e0;
              border-radius: 8px;
            "
          />
        </div>

        <div>
          <label
            style="
              display: block;
              font-weight: 600;
              color: #2c3e50;
              margin-bottom: 8px;
            "
            >–¢–µ–ª–µ—Ñ–æ–Ω</label
          >
          <input
            type="tel"
            name="phone"
            value="{{ staff.phone }}"
            style="
              width: 100%;
              padding: 12px;
              border: 2px solid #e0e0e0;
              border-radius: 8px;
            "
          />
        </div>
      </div>

      <div>
        <label
          style="
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
          "
          >–°–ø–µ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è</label
        >
        <input
          type="text"
          name="specialization"
          value="{{ staff.specialization }}"
          style="
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
          "
        />
      </div>

      <div style="border-top: 2px dashed #e0e0e0; padding-top: 20px">
        <h4 style="margin-bottom: 15px; color: #2c3e50">–ó–º—ñ–Ω–∞ –ø–∞—Ä–æ–ª—è</h4>
        <label
          style="
            display: block;
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 8px;
          "
          >–ù–æ–≤–∏–π –ø–∞—Ä–æ–ª—å (–º—ñ–Ω—ñ–º—É–º 6 —Å–∏–º–≤–æ–ª—ñ–≤)</label
        >
        <input
          type="password"
          name="new_password"
          placeholder="–ó–∞–ª–∏—à—Ç–µ –ø–æ—Ä–æ–∂–Ω—ñ–º, —â–æ–± –Ω–µ –∑–º—ñ–Ω—é–≤–∞—Ç–∏"
          style="
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
          "
        />
      </div>

      <button
        type="submit"
        style="
          padding: 14px 30px;
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          border: none;
          border-radius: 8px;
          font-weight: bold;
          cursor: pointer;
          transition: all 0.3s;
        "
      >
        üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏
      </button>
    </div>
  </form>
</div>

{% endblock %} ``` --- ## –ö—Ä–æ–∫ 7: –û–Ω–æ–≤–∏—Ç–∏ base.html –∑ –ø—Ä–æ—Ñ—ñ–ª–µ–º –û–Ω–æ–≤—ñ—Ç—å
`patients/templates/patients/base.html`, –∑–º—ñ–Ω—ñ—Ç—å –Ω–∞–≤—ñ–≥–∞—Ü—ñ—é: ```html
<!-- –ó–∞–º—ñ–Ω—ñ—Ç—å –±–ª–æ–∫ –Ω–∞–≤—ñ–≥–∞—Ü—ñ—ó –Ω–∞ —Ü–µ–π –∫–æ–¥ -->
<nav class="nav">
  <a href="{% url 'patient_list' %}">
    <span class="nav-icon">üë•</span>
    –ü–∞—Ü—ñ—î–Ω—Ç–∏
  </a>
  <a href="{% url 'register_patient' %}">
    <span class="nav-icon">‚ûï</span>
    –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
  </a>
  <a href="{% url 'analytics' %}">
    <span class="nav-icon">üìä</span>
    –ê–Ω–∞–ª—ñ—Ç–∏–∫–∞
  </a>

  <!-- –ü—Ä–æ—Ñ—ñ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -->
  {% if request.session.staff_id %}
  <div style="position: relative; display: inline-block">
    <button
      onclick="toggleProfileMenu()"
      style="
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 8px 16px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 500;
      "
    >
      <span style="font-size: 24px">{{ request.session.staff_avatar }}</span>
      <span>{{ request.session.staff_name|truncatechars:15 }}</span>
      <span style="font-size: 12px">‚ñº</span>
    </button>

    <div
      id="profileMenu"
      style="
        display: none;
        position: absolute;
        right: 0;
        top: 100%;
        margin-top: 10px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
        min-width: 250px;
        z-index: 1000;
        animation: slideDown 0.3s;
      "
    >
      <div style="padding: 20px; border-bottom: 1px solid #e0e0e0">
        <div
          style="
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
          "
        >
          <div style="font-size: 40px">{{ request.session.staff_avatar }}</div>
          <div>
            <div style="font-weight: 600; color: #2c3e50; margin-bottom: 3px">
              {{ request.session.staff_name }}
            </div>
            <div style="font-size: 12px; color: #7f8c8d">
              {{ request.session.staff_role }}
            </div>
          </div>
        </div>
      </div>

      <a
        href="{% url 'staff_profile' %}"
        style="
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 15px 20px;
          color: #2c3e50;
          text-decoration: none;
          transition: background 0.2s;
        "
      >
        <span style="font-size: 20px">üë§</span>
        <span>–û—Å–æ–±–∏—Å—Ç–∏–π –∫–∞–±—ñ–Ω–µ—Ç</span>
      </a>

      <a
        href="/admin/"
        target="_blank"
        style="
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 15px 20px;
          color: #2c3e50;
          text-decoration: none;
          transition: background 0.2s;
        "
      >
        <span style="font-size: 20px">‚öôÔ∏è</span>
        <span>–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</span>
      </a>

      <div style="border-top: 1px solid #e0e0e0"></div>

      <a
        href="{% url 'staff_logout' %}"
        style="
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 15px 20px;
          color: #e74c3c;
          text-decoration: none;
          transition: background 0.2s;
        "
      >
        <span style="font-size: 20px">üö™</span>
        <span>–í–∏–π—Ç–∏</span>
      </a>
    </div>
  </div>
  {% endif %}
</nav>

<script>
  function toggleProfileMenu() {
    const menu = document.getElementById("profileMenu");
    menu.style.display = menu.style.display === "none" ? "block" : "none";
  }

  // –ó–∞–∫—Ä–∏—Ç–∏ –º–µ–Ω—é –ø—Ä–∏ –∫–ª—ñ–∫—É –ø–æ–∑–∞ –Ω–∏–º
  document.addEventListener("click", function (event) {
    const menu = document.getElementById("profileMenu");
    const button = event.target.closest("button");

    if (!button && menu && menu.style.display === "block") {
      menu.style.display = "none";
    }
  });
</script>

<style>
  #profileMenu a:hover {
    background: #f8f9fa;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
